# Account Automation 맞춤형 시스템 설계서

> **프로젝트**: 이카운트 결제내역 자동 업로드
> **작성일**: 2024-12-31
> **대상 사용자**: zartkang@gmail.com

---

## 📋 요구사항 요약

### ⏰ 실행 스케줄
```
운영 시간: 06:00 ~ 18:00 (12시간)
실행 주기: 30분마다
실행 요일: 
  - 월~금: 06:00 ~ 18:00
  - 토요일: 06:00 ~ 14:00
  - 일요일: 실행 안 함
  - 공휴일: 실행 안 함

점심시간: 실행 계속 (중단 없음)

예상 실행 횟수:
  - 평일: 24회/일 (12시간 ÷ 0.5시간)
  - 토요일: 16회 (8시간 ÷ 0.5시간)
  - 주간 합계: 136회/주 ((24×5) + 16)
```

### 💻 시스템 환경
```
OS: Windows 11
관리자 권한: 없음 (사용자 권한만)
PC 운영: 퇴근 시 종료 (24시간 운영 아님)
  → 출근 시 수동 부팅 필요
  → Windows 시작 프로그램 등록 필요
```

### 📊 모니터링 & 알림
```
실행 모드:
  - 운영: 백그라운드 (headless=true)
  - 테스트: 화면 보임 (headless=false)

모니터링:
  - HTML 리포트 파일 (브라우저로 열람)
  - 또는 Excel 파일
  - 웹 대시보드 없음

알림:
  - 방법: 이메일
  - 수신: zartkang@gmail.com
  - 조건: 에러 발생 시 즉시 + 일일 요약
```

### 📁 데이터 처리
```
처리량: 50건 이상/회
로그 보관: 1주일 (7일)
우선순위: 안정성 > 모든 것
```

---

## 🏗️ 시스템 아키텍처

### 디렉토리 구조
```
C:\Users\{사용자}\Account_Automation\
├── main.py                          # 메인 실행 파일
├── config.json                      # 설정 파일 (gitignore)
├── config.example.json              # 설정 템플릿
├── requirements.txt                 # 의존성
├── install.bat                      # 원클릭 설치 스크립트
├── start.bat                        # 실행 스크립트
├── stop.bat                         # 중지 스크립트
├── test.bat                         # 테스트 모드 실행
│
├── src\                             # 소스 코드
│   ├── __init__.py
│   ├── config\
│   │   ├── __init__.py
│   │   ├── loader.py                # 설정 로더
│   │   └── validator.py             # 설정 검증
│   │
│   ├── core\
│   │   ├── __init__.py
│   │   ├── browser.py               # 브라우저 관리
│   │   ├── session.py               # 세션 관리
│   │   ├── scheduler.py             # 스케줄러
│   │   └── controller.py            # 제어 (중지/재개)
│   │
│   ├── ecount\
│   │   ├── __init__.py
│   │   ├── auth.py                  # 로그인
│   │   ├── extractor.py             # 데이터 추출
│   │   ├── transformer.py           # 데이터 변환
│   │   └── uploader.py              # 업로드
│   │
│   ├── monitor\
│   │   ├── __init__.py
│   │   ├── logger.py                # 로깅 시스템
│   │   ├── metrics.py               # 통계 수집
│   │   ├── reporter.py              # 리포트 생성
│   │   └── notifier.py              # 이메일 알림
│   │
│   └── utils\
│       ├── __init__.py
│       ├── clipboard.py             # 클립보드 관리
│       ├── file_manager.py          # 파일 관리
│       ├── record_keeper.py         # 업로드 기록
│       └── holiday_checker.py       # 공휴일 체크
│
├── control\                         # 제어 파일
│   ├── STOP.txt                     # 긴급 정지
│   ├── SHUTDOWN.txt                 # 정상 종료
│   ├── PAUSE.txt                    # 일시 정지
│   ├── status.json                  # 현재 상태
│   └── automation.lock              # 중복 실행 방지
│
├── logs\                            # 로그 파일 (1주일 보관)
│   ├── automation_20241231.log
│   ├── automation_20241230.log
│   └── ... (7일치)
│
├── sessions\                        # 세션 저장
│   └── ecount_session.json
│
├── reports\                         # 리포트 파일
│   ├── daily_report_20241231.html   # HTML 리포트
│   ├── daily_report_20241231.xlsx   # Excel 리포트 (선택)
│   └── latest.html                  # 최신 리포트 (심볼릭 링크)
│
├── data\                            # 데이터 파일
│   ├── uploaded_records.json        # 업로드 기록
│   ├── holidays.json                # 공휴일 목록
│   └── metrics.json                 # 누적 통계
│
└── docs\                            # 문서
    ├── 설치_가이드.md
    ├── 사용_매뉴얼.md
    ├── 트러블슈팅.md
    └── FAQ.md
```

---

## ⚙️ 핵심 설정

### config.json
```json
{
  "credentials": {
    "company_code": "650217",
    "username": "zartkang",
    "password": "your_password_here"
  },
  
  "schedule": {
    "enabled": true,
    "interval_minutes": 30,
    "work_hours": {
      "start": "06:00",
      "end": "18:00"
    },
    "work_days": {
      "monday": {"enabled": true, "hours": "06:00-18:00"},
      "tuesday": {"enabled": true, "hours": "06:00-18:00"},
      "wednesday": {"enabled": true, "hours": "06:00-18:00"},
      "thursday": {"enabled": true, "hours": "06:00-18:00"},
      "friday": {"enabled": true, "hours": "06:00-18:00"},
      "saturday": {"enabled": true, "hours": "06:00-14:00"},
      "sunday": {"enabled": false}
    },
    "exclude_holidays": true
  },
  
  "browser": {
    "headless": true,
    "test_mode": false,
    "timeout": 30000,
    "slow_mo": 0,
    "viewport": {
      "width": 1920,
      "height": 1080
    }
  },
  
  "monitoring": {
    "log_level": "INFO",
    "log_retention_days": 7,
    "screenshot_on_error": true,
    "report_format": "html",
    "enable_excel_report": false
  },
  
  "notification": {
    "email": {
      "enabled": true,
      "smtp_server": "smtp.gmail.com",
      "smtp_port": 587,
      "sender": "automation@yourdomain.com",
      "sender_password": "app_password_here",
      "recipient": "zartkang@gmail.com",
      "send_on_error": true,
      "send_daily_summary": true,
      "summary_time": "18:00"
    }
  },
  
  "data": {
    "record_retention_days": 90,
    "enable_duplicate_check": true,
    "backup_before_cleanup": true
  },
  
  "control": {
    "max_retry": 3,
    "retry_delay_seconds": 300,
    "auto_recovery": true,
    "check_interval_seconds": 10
  }
}
```

---

## 🚀 자동 시작 설정

### Windows 시작 프로그램 등록 (관리자 권한 불필요)

#### 방법 1: 시작 폴더에 바로가기 추가 (권장)
```batch
REM setup_autostart.bat

@echo off
echo ========================================
echo Account Automation 자동 시작 설정
echo ========================================
echo.

REM 시작 폴더 경로
set STARTUP_FOLDER=%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup

REM 현재 디렉토리
set CURRENT_DIR=%~dp0

REM 바로가기 생성 (PowerShell 사용)
powershell -Command "$WshShell = New-Object -ComObject WScript.Shell; $Shortcut = $WshShell.CreateShortcut('%STARTUP_FOLDER%\Account_Automation.lnk'); $Shortcut.TargetPath = '%CURRENT_DIR%start.bat'; $Shortcut.WorkingDirectory = '%CURRENT_DIR%'; $Shortcut.WindowStyle = 7; $Shortcut.Save()"

echo.
echo 자동 시작이 설정되었습니다!
echo.
echo 확인 방법:
echo 1. Win+R 키 누르기
echo 2. "shell:startup" 입력
echo 3. "Account_Automation" 바로가기 확인
echo.
pause
```

#### 방법 2: 작업 스케줄러 (사용자 권한)
```batch
REM setup_scheduler.bat

@echo off
echo ========================================
echo 작업 스케줄러 등록
echo ========================================
echo.

REM 현재 디렉토리
set TASK_DIR=%~dp0

REM 작업 이름
set TASK_NAME=Account_Automation

REM 기존 작업 삭제 (있으면)
schtasks /Delete /TN "%TASK_NAME%" /F 2>nul

REM 새 작업 생성
schtasks /Create /TN "%TASK_NAME%" /TR "%TASK_DIR%start.bat" /SC DAILY /ST 06:00 /RL LIMITED /F

echo.
echo 작업 스케줄러 등록 완료!
echo.
echo 작업 정보:
echo - 이름: %TASK_NAME%
echo - 시작 시간: 매일 06:00
echo - 실행 파일: %TASK_DIR%start.bat
echo.
echo 확인 방법:
echo 1. Win+R 키 누르기
echo 2. "taskschd.msc" 입력
echo 3. "%TASK_NAME%" 검색
echo.
pause
```

### start.bat (실행 스크립트)
```batch
@echo off
REM Account Automation 시작 스크립트

cd /d %~dp0

REM 중복 실행 확인
tasklist /FI "WINDOWTITLE eq Account_Automation*" | find "python.exe" >nul
if %ERRORLEVEL% == 0 (
    echo 이미 실행 중입니다.
    exit /b 1
)

REM Python 가상환경 활성화 (있으면)
if exist venv\Scripts\activate.bat (
    call venv\Scripts\activate.bat
)

REM 프로그램 실행 (백그라운드)
start "Account_Automation" /MIN pythonw main.py

echo Account Automation이 백그라운드에서 시작되었습니다.
echo.
echo 상태 확인: control\status.json
echo 중지: stop.bat 실행
```

### stop.bat (중지 스크립트)
```batch
@echo off
REM Account Automation 중지 스크립트

cd /d %~dp0

echo 정상 종료 신호 전송 중...
echo. > control\SHUTDOWN.txt

echo.
echo 프로그램이 현재 작업 완료 후 종료됩니다.
echo 강제 종료: Ctrl+C 또는 작업 관리자
echo.
pause
```

### test.bat (테스트 모드)
```batch
@echo off
REM Account Automation 테스트 모드

cd /d %~dp0

REM Python 가상환경 활성화
if exist venv\Scripts\activate.bat (
    call venv\Scripts\activate.bat
)

REM 테스트 모드로 실행 (화면 보임)
python main.py --test-mode

pause
```

---

## 📧 이메일 알림 시스템

### Gmail SMTP 설정

#### 1단계: Google 앱 비밀번호 생성
```
1. Google 계정 관리 (https://myaccount.google.com)
2. 보안 > 2단계 인증 활성화
3. 앱 비밀번호 생성
   - 앱 선택: 기타 (Account Automation)
   - 16자리 비밀번호 복사
4. config.json의 sender_password에 입력
```

#### 2단계: SMTP 설정
```json
{
  "notification": {
    "email": {
      "enabled": true,
      "smtp_server": "smtp.gmail.com",
      "smtp_port": 587,
      "sender": "your-gmail@gmail.com",
      "sender_password": "xxxx xxxx xxxx xxxx",
      "recipient": "zartkang@gmail.com"
    }
  }
}
```

### 알림 종류

#### 1. 에러 발생 시 (즉시)
```
제목: [Account Automation] 에러 발생 - 2024-12-31 10:30

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚨 에러 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
시간: 2024-12-31 10:30:15
에러 코드: D01
에러 타입: 로그인 실패
에러 메시지: 비밀번호가 올바르지 않습니다

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 조치 사항
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. config.json의 비밀번호 확인
2. 이카운트 웹사이트에서 직접 로그인 테스트
3. 문제 지속 시 관리자 문의

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔧 재시도 정보
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
재시도 횟수: 1/3
다음 재시도: 5분 후 (10:35)
자동 복구: 활성화

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📎 첨부 파일
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 스크린샷: error_20241231_103015.png
- 로그 파일: automation_20241231.log

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
이 메일은 Account Automation 시스템에서 자동 발송되었습니다.
```

#### 2. 일일 요약 (18:00)
```
제목: [Account Automation] 일일 리포트 - 2024-12-31

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 실행 통계 (06:00 ~ 18:00)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
총 실행 횟수: 24회
성공: 23회 (95.8%)
실패: 1회 (4.2%)
평균 실행 시간: 2분 18초

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 데이터 처리
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
총 레코드: 1,245건
업로드 성공: 1,238건 (99.4%)
중복 스킵: 5건
실패: 2건

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⏱️ 실행 시간 분석
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
최단: 1분 45초 (14:00)
최장: 3분 30초 (10:30, 에러 재시도 포함)
중간값: 2분 15초

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ 에러 요약
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
10:30 - 로그인 실패 (재시도 성공)
  → 원인: 일시적 네트워크 문제
  → 조치: 자동 복구됨

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📉 시간대별 처리 현황
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
06:00-09:00: 6회 (320건)
09:00-12:00: 6회 (280건)
12:00-15:00: 6회 (315건)
15:00-18:00: 6회 (330건)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 권장 사항
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✓ 시스템 정상 운영 중
- 로그 파일 크기: 125MB (1주일 보관 중)
- 다음 자동 정리: 2025-01-07

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔗 링크
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
상세 리포트: C:\Users\...\reports\daily_report_20241231.html
로그 파일: C:\Users\...\logs\automation_20241231.log
```

#### 3. 연속 실패 시 (3회 실패)
```
제목: [긴급] Account Automation 연속 3회 실패!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚨 긴급 알림
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
자동화 프로그램이 연속 3회 실패했습니다.
즉시 확인이 필요합니다!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
실패 기록:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1차: 10:00 - 네트워크 타임아웃
2차: 10:30 - 네트워크 타임아웃
3차: 11:00 - 네트워크 타임아웃

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
추정 원인:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 인터넷 연결 불안정
- VPN 연결 끊김 가능성
- 이카운트 서버 점검 중

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
조치 필요:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. 네트워크 연결 상태 확인
2. 이카운트 웹사이트 접속 테스트
3. 로그 파일 확인 (첨부)
4. 필요 시 프로그램 재시작

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
자동 조치:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
- 현재 프로그램 일시 정지 중
- 다음 시도: 30분 후 (11:30)
- 수동 재시작: start.bat 실행
```

---

## 📊 HTML 리포트 형식

### daily_report.html 예시
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Automation 일일 리포트 - 2024-12-31</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .metric {
            display: inline-block;
            margin: 10px 20px 10px 0;
        }
        .metric-value {
            font-size: 36px;
            font-weight: bold;
            color: #667eea;
        }
        .metric-label {
            font-size: 14px;
            color: #666;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .chart {
            height: 300px;
            margin: 20px 0;
        }
        .status-ok { 
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
        }
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>📊 Account Automation 일일 리포트</h1>
        <p>2024년 12월 31일 (화요일)</p>
        <p>운영 시간: 06:00 ~ 18:00</p>
    </div>

    <div class="card">
        <h2>🎯 오늘의 요약</h2>
        <div class="status-ok">
            ✓ 시스템 정상 운영 중 (성공률 95.8%)
        </div>
    </div>

    <div class="card">
        <h2>📈 핵심 지표</h2>
        <div class="metric">
            <div class="metric-value">24</div>
            <div class="metric-label">총 실행 횟수</div>
        </div>
        <div class="metric">
            <div class="metric-value success">23</div>
            <div class="metric-label">성공</div>
        </div>
        <div class="metric">
            <div class="metric-value error">1</div>
            <div class="metric-label">실패</div>
        </div>
        <div class="metric">
            <div class="metric-value">1,245</div>
            <div class="metric-label">처리 레코드</div>
        </div>
        <div class="metric">
            <div class="metric-value">2:18</div>
            <div class="metric-label">평균 시간</div>
        </div>
    </div>

    <div class="card">
        <h2>⏱️ 시간대별 실행 내역</h2>
        <table>
            <thead>
                <tr>
                    <th>시간</th>
                    <th>상태</th>
                    <th>처리 건수</th>
                    <th>소요 시간</th>
                    <th>비고</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>06:00</td>
                    <td class="success">✓ 성공</td>
                    <td>52</td>
                    <td>2:15</td>
                    <td>-</td>
                </tr>
                <tr>
                    <td>06:30</td>
                    <td class="success">✓ 성공</td>
                    <td>48</td>
                    <td>2:10</td>
                    <td>-</td>
                </tr>
                <!-- 생략 -->
                <tr>
                    <td>10:30</td>
                    <td class="error">✗ 실패</td>
                    <td>0</td>
                    <td>0:45</td>
                    <td>로그인 실패 (재시도 성공)</td>
                </tr>
                <!-- 생략 -->
            </tbody>
        </table>
    </div>

    <div class="card">
        <h2>⚠️ 에러 상세</h2>
        <table>
            <thead>
                <tr>
                    <th>시간</th>
                    <th>에러 코드</th>
                    <th>내용</th>
                    <th>조치</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>10:30:15</td>
                    <td>D01</td>
                    <td>로그인 실패 - 일시적 네트워크 문제</td>
                    <td>자동 재시도 (성공)</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="card">
        <h2>📁 시스템 상태</h2>
        <table>
            <tr>
                <th>항목</th>
                <th>현재 상태</th>
            </tr>
            <tr>
                <td>프로그램 버전</td>
                <td>1.0.0</td>
            </tr>
            <tr>
                <td>마지막 실행</td>
                <td>2024-12-31 18:00:00</td>
            </tr>
            <tr>
                <td>세션 상태</td>
                <td class="success">활성</td>
            </tr>
            <tr>
                <td>누적 업로드 기록</td>
                <td>15,230건</td>
            </tr>
            <tr>
                <td>로그 파일 크기</td>
                <td>125MB (7일)</td>
            </tr>
            <tr>
                <td>다음 실행 예정</td>
                <td>2025-01-01 06:00:00</td>
            </tr>
        </table>
    </div>

    <div class="card">
        <h2>💡 권장 사항</h2>
        <ul>
            <li>✓ 시스템 정상 운영 중입니다.</li>
            <li>로그 파일이 125MB입니다. 1주일 후 자동 정리됩니다.</li>
        </ul>
    </div>

    <footer style="text-align: center; color: #666; margin-top: 40px;">
        <p>Account Automation System v1.0.0</p>
        <p>생성 시간: 2024-12-31 18:00:05</p>
    </footer>
</body>
</html>
```

---

## 🛡️ 안정성 확보 전략

### 1. 에러 처리 계층
```
Level 1: 즉시 복구 (자동)
  - 네트워크 타임아웃 → 재시도
  - 세션 만료 → 재로그인
  - 브라우저 크래시 → 재시작

Level 2: 지연 복구 (자동)
  - 연속 3회 실패 → 30분 대기 후 재시도
  - 디스크 공간 부족 → 로그 정리 후 재시도

Level 3: 수동 개입 필요
  - 로그인 계정 잠김 → 이메일 알림
  - 선택자 변경 (UI 변경) → 이메일 알림
  - 연속 5회 실패 → 이메일 알림 + 중지
```

### 2. 재시도 전략
```python
# 지수 백오프 (Exponential Backoff)
재시도 1차: 즉시
재시도 2차: 5분 후
재시도 3차: 15분 후 (5 + 10)

# 최대 재시도 후에도 실패 시
→ 다음 스케줄까지 대기 (최대 30분)
→ 이메일 알림 발송
```

### 3. 데이터 무결성 보장
```
처리 전: uploaded_records.json 백업
처리 중: 트랜잭션 로그 기록
처리 후: 백업 삭제, 성공 기록 저장
에러 시: 백업에서 복원
```

### 4. 리소스 관리
```
메모리 사용: 최대 500MB
  → 초과 시 경고 로그
  → 1GB 초과 시 재시작

CPU 사용: 평균 30% 이하 유지
  → 대기 시간 추가로 조절

디스크 공간: 최소 1GB 유지
  → 부족 시 자동 로그 정리
```

### 5. 로그 관리 (1주일 보관)
```
자동 정리 스케줄:
  - 매일 18:30 (업무 종료 후)
  - 7일 이전 로그 삭제
  - 삭제 전 압축 백업 (선택)

로그 파일 크기 제한:
  - 하루 최대 50MB
  - 초과 시 rotation (1, 2, 3...)
```

---

## 🗓️ 공휴일 처리

### holidays.json
```json
{
  "2025": [
    "2025-01-01",
    "2025-02-09",
    "2025-02-10",
    "2025-02-11",
    "2025-03-01",
    "2025-03-03",
    "2025-05-05",
    "2025-05-15",
    "2025-06-06",
    "2025-08-15",
    "2025-09-06",
    "2025-09-07",
    "2025-09-08",
    "2025-10-03",
    "2025-10-09",
    "2025-12-25"
  ],
  "2026": [
    "2026-01-01"
  ]
}
```

### 공휴일 자동 업데이트
```python
# 공공데이터포털 API 사용 (선택)
# 또는 수동 업데이트
```

---

## 📝 일일 체크리스트 (선택)

### 출근 시 (매일 06:00)
```
□ PC 부팅
□ 자동 시작 확인 (작업 표시줄 확인)
□ 상태 파일 확인 (control\status.json)
```

### 퇴근 시 (매일 18:00)
```
□ 일일 리포트 확인 (이메일 또는 reports\latest.html)
□ 에러 없는지 확인
□ PC 종료 (자동 종료됨)
```

### 주간 점검 (금요일 18:00)
```
□ 주간 통계 확인
□ 로그 파일 크기 확인
□ 다음 주 공휴일 확인
```

---

## 🎯 다음 단계

### Phase 1: 설치 및 초기 설정 (30분)
```
1. Python 설치 확인
2. 프로젝트 다운로드/복사
3. install.bat 실행 (자동 설치)
4. config.json 설정 (비밀번호, 이메일)
5. 테스트 모드 실행 (test.bat)
6. 정상 동작 확인
```

### Phase 2: 자동 시작 설정 (10분)
```
1. setup_autostart.bat 실행
2. PC 재부팅 테스트
3. 자동 시작 확인
```

### Phase 3: 모니터링 설정 (15분)
```
1. Gmail 앱 비밀번호 생성
2. config.json에 SMTP 설정
3. 테스트 이메일 발송 확인
4. 일일 리포트 확인
```

### Phase 4: 안정화 (1주일)
```
1. 매일 리포트 모니터링
2. 에러 발생 시 로그 확인
3. 필요 시 설정 조정
4. 완전 자동화 확정
```

---

## 📞 지원 및 문의

### 문제 발생 시
```
1. 로그 파일 확인 (logs\automation_YYYYMMDD.log)
2. 상태 파일 확인 (control\status.json)
3. 리포트 확인 (reports\latest.html)
4. docs\트러블슈팅.md 참고
```

### 자주 묻는 질문 (FAQ)
```
Q. 프로그램이 시작 안 돼요
A. logs\automation_YYYYMMDD.log 확인
   Python 설치 확인 (python --version)

Q. 로그인이 계속 실패해요
A. config.json의 비밀번호 확인
   이카운트 웹사이트에서 직접 로그인 테스트

Q. 이메일 알림이 안 와요
A. config.json의 SMTP 설정 확인
   Gmail 앱 비밀번호 재생성

Q. PC 재부팅 후 자동 시작 안 돼요
A. shell:startup 폴더 확인
   바로가기 존재 여부 확인
```

---

**이제 모든 설계가 완료되었습니다!** 🎉

다음은 실제 코드 구현입니다.
