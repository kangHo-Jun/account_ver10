📋 최종 체크리스트 및 우선순위
🔴 긴급 (Critical)
저장 성공 개수 비교 로직 추가 (uploader.py:149-152)
success_count != expected_count 검증
0건 성공도 실패로 처리
업로드 반환값 변경 (bool → dict)
실제 업로드 건수 반환
main.py에서 건수 확인 후 레코드 저장
팝업 오픈 검증 (uploader.py:53-54)
wait_for_selector 사용
타임아웃 시 즉시 실패 처리
🟡 중요 (High)
붙여넣기 후 그리드 행 개수 검증
tr[data-index] 개수 확인
불일치 시 재시도 1회
역방향 검증 구현
업로드 후 '회계반영' 탭 재조회
승인번호 일치 여부 확인
포커스 확보 강화
다단계 폴백 메서드
실패 시 즉시 중단 (무시 금지)
🟢 개선 (Medium)
팝업 스택 완전 정리 함수
재시도 메커니즘
상세 오류 타입 분류
Update Todos

UploaderModule 코드 심층 분석

팝업 처리 오류 케이스 도출

허위 업로드 검증 메커니즘 설계

개선 코드 작성 - 업로드 검증 강화

개선 코드 작성 - 역방향 검증 구현
🎯 요약 답변
질문 1: 팝업 처리 오류 케이스
발견된 6가지 치명적 취약점:
❌ 팝업 오픈 검증 부재 → 안 열린 상태로 진행
❌ 포커스 실패 무시 → 엉뚱한 곳에 데이터 입력
❌ 붙여넣기 검증 불완전 → 0건 붙여넣기도 통과
❌ 팝업 개수 기반 감지 → 다른 팝업을 결과로 오인
❌ 닫기 버튼 불안정 → 팝업 스택 쌓임
❌ 정리 로직 불완전 → 다음 사이클 실패
질문 2: 허위 업로드 방지
현재 코드의 치명적 허점:
"성공: 0건"도 True 반환
기대 건수와 실제 건수 비교 안 함
업로드 후 ERP에서 재확인하지 않음
근본적 해결 방법:
✅ 엄격한 개수 검증: success_count == expected_count 확인
✅ 역방향 검증: 업로드 후 '회계반영' 탭에서 실제 반영 확인
✅ 반환값 변경: dict로 상세 정보 반환
✅ 조건부 레코드 저장: 역방향 검증 성공 시에만 저장